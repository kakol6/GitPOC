<?xml version = '1.0' encoding = 'UTF-8'?>
<!--
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  Oracle JDeveloper BPEL Designer 
  
  Created: 
  Author:  AIAServiceConstructor Oracle SOA Toolbox
  Purpose: Provider CreateDeliveryScheduleDESProvABCS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
--><process name="CreateDeliveryScheduleDESProvABCSProcess" targetNamespace="ikea.com/system/iip/CreateDeliveryScheduleDESProvABCSService/1.0/" xmlns:abcsns="ikea.com/system/iip/CreateDeliveryScheduleDESProvABCSService/1.0/" xmlns:servicereqelns="ikea.com/cem/DeliverySchedule/1.0/" xmlns:servicereselns="ikea.com/cem/DeliverySchedule/1.0/" xmlns:servicefaultelns="ikea.com/system/iip/IIPHeader/1.0/" xmlns:targetns="ikea.com/system/DES/CreateDeliveryScheduleService/1.0/" xmlns:targetreqelns="ikea.com/system/DES/CreateDeliverySchedule/1.0/" xmlns:targetreselns="ikea.com/system/DES/CreateDeliverySchedule/1.0/" xmlns:aia="http://www.oracle.com/XSL/Transform/java/oracle.apps.aia.core.xpath.AIAFunctions" xmlns:coreheader="ikea.com/system/iip/IIPHeader/1.0/" xmlns:corefault="ikea.com/system/iip/IIPFaultMessage/1.0/" xmlns:ikeaeh="ikea.com/system/iip/IIPAsyncErrorHandlingService/1.0/" xmlns:xacml="urn:oasis:names:tc:xacml:2.0:context:schema:cd:04" xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions" xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20" xmlns:wsa="http://schemas.xmlsoap.org/ws/2003/03/addressing" xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath" xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ora="http://schemas.oracle.com/xpath/extension" xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath" xmlns:ehdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.esb.server.headers.ESBHeaderFunctions" xmlns:bpelx="http://schemas.oracle.com/bpel/extension" xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:bpel2="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue" xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk" xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions" xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator" xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction" xmlns:soaxpath="http://ns.oracle-soa.se/aia/bpel/xpath" xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:med="http://schemas.oracle.com/mediator/xpath" xmlns:ns1="ikea.com/cem/OrderAndDelivery/DeliverySchedule/V0/" xmlns:ns2="http://oracle.com/sca/soapservice/delivery-schedule-sca-cem/CreateDeliveryScheduleDESProvABCS/ReceiveDeliveryScheduleResponse" xmlns:ns3="ikea.com/system/iip/ReceiveDeliveryScheduleResponseService/1.0/" xmlns:ns4="http://ws.fwk.ikea.com/business-call" xmlns:ns5="http://xmlns.oracle.com/CreateDeliveryScheduleDESProvABCS/correlationset" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ns6="ikea.com/system/iip/ManualScheduleResponse/V0/" xmlns:bam="ikea.com/system/iip/bamAuditMessage/1.0/" xmlns:ess="http://xmlns.oracle.com/scheduler" xmlns:bpelxpath="http://ns.oracle-soa.se/bpel/xpath" xmlns:ns7="http://ws.fwk.ikea.com/fwk-service-call" id="BpPrc0">
    <bpelx:annotation>
        <bpelx:analysis>
            <bpelx:property name="wsdlFile">
                ../WSDLs/CreateDeliveryScheduleDESProvABCSProcess.wsdl
            </bpelx:property>
        </bpelx:analysis>
    </bpelx:annotation>
    <partnerLinks>
        <partnerLink myRole="IIPAsyncErrorHandlingProcessRequester" name="IIPAsyncErrorHandlingProcess" partnerRole="IIPAsyncErrorHandlingProcessProvider" partnerLinkType="ikeaeh:IIPAsyncErrorHandlingProcess"/>
        <partnerLink myRole="CreateDeliveryScheduleDESProvABCSProvider" name="CreateDeliveryScheduleDESProvABCS" partnerLinkType="abcsns:CreateDeliveryScheduleDESProvABCS"/>
        <!--partnerLink name="ReceiveDeliveryScheduleResponseService"
                     partnerLinkType="ns3:ReceiveDeliveryScheduleResponseService"
                     myRole="ReceiveDeliveryScheduleResponse_ptt"/-->
        <partnerLink name="CreateDeliveryScheduleDES" partnerLinkType="ns4:CreateDeliveryScheduleDESResponse_PL" partnerRole="CreateDeliveryScheduleDESResponse_Role"/>
    </partnerLinks>
    <variables>
        <!--variable name="CreateDeliveryScheduleReqMsg"
                  messageType="abcsns:CreateDeliveryScheduleReqMsg"/-->
        <variable name="CreateDeliveryScheduleResMsg" messageType="abcsns:CreateDeliveryScheduleResMsg"/>
        <variable name="CreateDeliveryScheduleFaultMsg" messageType="abcsns:FaultMsg"/>
        <variable name="SystemFaultVar" messageType="bpelx:RuntimeFaultMessage"/>
        <variable name="IIPAsyncErrorHandlingProcessRequestMessage" messageType="ikeaeh:IIPAsyncErrorHandlingProcessRequestMessage"/>
        <variable name="SystemFaultMsg" messageType="bpelx:RuntimeFaultMessage"/>
        <variable name="SystemID" type="xsd:string"/>
        <variable name="Title" type="xsd:string"/>
        <variable name="EBM_HEADER" element="coreheader:EBMHeader"/>
        <variable name="InstanceID" type="xsd:string"/>
        <variable name="ServiceName" type="xsd:string"/>
        <variable name="TraceLogEnabled" type="xsd:boolean"/>
        <variable name="IsError" type="xsd:boolean"/>
        <variable name="CreateDeliveryScheduleReqMsg" messageType="abcsns:CreateDeliveryScheduleReqMsg"/>
        <!--variable name="Invoke_CreateDeliveryScheduleDES_CreateDeliverySchedule_InputVariable"
                  messageType="ns4:ScheduleShipmentRequest"/>
        <variable name="Invoke_CreateDeliveryScheduleDES_CreateDeliverySchedule_OutputVariable"
                  messageType="ns4:ScheduleShipmentResponse"/-->
        <variable name="BamAuditMessageSensorVariable" element="bam:bamAuditMessageRequest"/>
        <variable name="BamAuditMessageVariable" element="bam:bamAuditMessageRequest"/>
        <variable name="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable" messageType="ns4:ScheduleLocationsRequest"/>
        <variable name="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable" messageType="ns4:ScheduleLocationsResponse"/>
        <variable name="MessageId" type="xsd:string"/>
        <variable name="ClientID" type="xsd:string"/>
        <variable name="EnvironmentID" type="xsd:string"/>
        <variable name="endPointRef" element="wsa:EndpointReference"/>
        <variable name="Cache_Key" type="xsd:string"/>
		<variable name="isTargetError" type="xsd:string"/>
    </variables>
    <correlationSets>
        <correlationSet name="ManualResponseCorrelation" properties="ns5:shipmentId"/>
    </correlationSets>
    <!--correlationSets>
        <correlationSet name="CorrelationSet1" properties="ns5:ShipmentName"/>
    </correlationSets-->
    <sequence name="global_Sequence" id="BpSeq0">
        <scope name="MainScope" id="BpScp0">
            <faultHandlers id="BpFhs0">
                <catch faultName="bpelx:remoteFault" faultVariable="SystemFaultVar" id="BpCFt0">
                    <sequence name="RemoteFault_Sequence" id="BpSeq1">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe0">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceFault("RemoteFault", getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Assign_Error" id="BpAss0">
                            <copy>
                                <from expression="ora:processXSLT('Transformations/EBM_to_Fault.xsl',bpws:getVariableData('EBM_HEADER'))"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="code"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorCode"/>
                            </copy>
                            <copy>
                                <from variable="SystemFaultVar" part="summary"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorText"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="detail"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:StackTrace"/>
                            </copy>
                            <copy>
                                <from expression="true()"/>
                                <to variable="IsError"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="dvm:lookupValue('oramds:/apps/AIAMetaData/IIPComponents/dvm/Common/DeliverySchedule_IIP_EH_ALERT_LIST.dvm','AlertName','ITM_DES_SHP_P_PROV_001','AlertValue','')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:AlertID"/>
                            </copy>
							<copy>
                                <from expression="true()"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="isTargetError"/>
                            </copy>						  
                        </assign>
                    </sequence>
                </catch>
                <catch faultName="bpelx:bindingFault" faultVariable="SystemFaultVar" id="BpCFt1">
                    <sequence name="BindingFault_Sequence" id="BpSeq2">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe1">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceFault("BindingFault", getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Assign_Error" id="BpAss1">
                            <copy>
                                <from expression="ora:processXSLT('Transformations/EBM_to_Fault.xsl',bpws:getVariableData('EBM_HEADER'))"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="code"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorCode"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="summary"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorText"/>
                            </copy>
                            <copy>
                                <from expression="true()"/>
                                <to variable="IsError"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="dvm:lookupValue('oramds:/apps/AIAMetaData/IIPComponents/dvm/Common/DeliverySchedule_IIP_EH_ALERT_LIST.dvm','AlertName','ITM_DES_SHP_P_PROV_002','AlertValue','')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:AlertID"/>
                            </copy>
                            <copy>
                                <from expression="true()"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="isTargetError"/>
                            </copy>
                        </assign>
                    </sequence>
                </catch>
                <catch faultName="bpelx:subLanguageExecutionFault" faultVariable="SystemFaultVar" id="BpCFt2">
                    <sequence name="SubLanguageFault_Sequence" id="BpSeq3">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe2">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceFault("SubLanguageExecution", getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Assign_Error" id="BpAss2">
                            <copy>
                                <from expression="ora:processXSLT('Transformations/EBM_to_Fault.xsl',bpws:getVariableData('EBM_HEADER'))"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="code"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorCode"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from variable="SystemFaultVar" part="summary"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorText"/>
                            </copy>
                            <copy>
                                <from expression="true()"/>
                                <to variable="IsError"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="dvm:lookupValue('oramds:/apps/AIAMetaData/IIPComponents/dvm/Common/DeliverySchedule_IIP_EH_ALERT_LIST.dvm','AlertName','ITM_DES_SHP_P_PROV_003','AlertValue','')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:AlertID"/>
                            </copy>
                        </assign>
                    </sequence>
                </catch>
                <catchAll id="BpCAl0">
                    <sequence name="CheckAll_Sequence" id="BpSeq4">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe3">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceFault("CatchAll", getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Assign_Error" id="BpAss3">
                            <copy>
                                <from expression="ora:processXSLT('Transformations/EBM_to_Fault.xsl',bpws:getVariableData('EBM_HEADER'))"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="ora:getFaultName()"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorCode"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="ora:getFaultAsString()"/>
                                <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ErrorText"/>
                            </copy>
                            <copy>
                                <from expression="true()"/>
                                <to variable="IsError"/>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                <from expression="dvm:lookupValue('oramds:/apps/AIAMetaData/IIPComponents/dvm/Common/DeliverySchedule_IIP_EH_ALERT_LIST.dvm','AlertName','ITM_DES_SHP_P_PROV_004','AlertValue','')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:AlertID"/>
                            </copy>
                        </assign>
                    </sequence>
                </catchAll>
            </faultHandlers>
            <sequence name="main_Sequence" id="BpSeq5">
                <scope name="Init" id="BpScp1">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">InitScope</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <sequence id="BpSeq6">
                        <receive name="CreateDeliverySchedule" portType="abcsns:CreateDeliveryScheduleDESProvABCS" variable="CreateDeliveryScheduleReqMsg" createInstance="yes" partnerLink="CreateDeliveryScheduleDESProvABCS" operation="CreateDeliverySchedule" id="BpRcv0"/>
                        <assign name="Assign_EBM_HEADER" id="BpAss4">
                            <copy>
                                <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM" query="/ns1:CreateDeliveryScheduleEBM/servicefaultelns:EBMHeader"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="EBM_HEADER" query="/servicefaultelns:EBMHeader"/>
                            </copy>
                            <copy>
                                <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM" query="/ns1:CreateDeliveryScheduleEBM/servicefaultelns:EBMHeader/servicefaultelns:MessageID"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="MessageId"/>
                            </copy>
                            <copy>
                                <from expression="ora:getPreference('clientId')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="ClientID"/>
                            </copy>
                            <copy>
                                <from expression="ora:getPreference('environmentId')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="EnvironmentID"/>
                            </copy>
                        </assign>
                        <assign name="GetTitle" id="BpAss5">
                            <copy>
                                  <from expression="concat('CreateDeliverySchedule-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                <to variable="Title"/>
                            </copy>
                            <copy>
                                <from expression="ora:getInstanceId()"/>
                                <to variable="InstanceID"/>
                            </copy>
                            <copy>
                                <from expression="ora:getProcessId()"/>
                                <to variable="ServiceName"/>
                            </copy>
                            <copy>
                                <from expression="false()"/>
                                <to variable="IsError"/>
                            </copy>
                            <copy>
                                <from expression="ora:getPreference('tracingEnabled')"/>
                                <to variable="TraceLogEnabled"/>
                            </copy>
                        </assign>
                        <bpelx:exec name="SetTitle" language="java" version="1.5" id="BxExe4">
                            oraext:setFlowInstanceTitle((String)getVariableData("Title"));
                        </bpelx:exec>
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe5">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.startInstance(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                    </sequence>
                </scope>
                <scope name="EnrichScope" id="BpScp2">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">EnrichScope</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <sequence id="BpSeq7">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe6">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
				if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceEnrich(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                    </sequence>
                </scope>
                <scope name="Transform" id="BpScp3">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">TransformScope</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <sequence id="BpSeq8">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe7">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceTransform(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Xform_CreateDeliveryScheduleReqMsg_To_CreateDeliveryScheduleRequestMessage" id="BpAss6">
                            <bpelx:annotation>
                                <bpelx:pattern>transformation</bpelx:pattern>
                            </bpelx:annotation>
                            <copy>
                                <from expression="ora:doXSLTransformForDoc('../Transformations/Xform_CreateDeliveryScheduleReqMsg_To_CreateDeliveryScheduleRequestMessage.xsl', $CreateDeliveryScheduleReqMsg.CreateDeliveryScheduleEBM,'MessageId', $MessageId, 'EnvironmentID', $EnvironmentID, 'ClientID', $ClientID)"/>
                                <to variable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable" part="pRequest"/>
                            </copy>
                        </assign>
                        <!--
                        <assign name="Assign_ITFHeaderValues">
                            <copy>
                                <from expression="ora:getPreference('clientId')"/>
                                <to variable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable"
                                    part="pRequest" query="/ns4:BsScheduleLocationsRequest/ns4:EBCHeader/ns7:clientId"/>
                            </copy>
                            
                            <copy>
                                <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                                      variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"
                                      query="/ns1:CreateDeliveryScheduleEBM/servicefaultelns:EBMHeader/servicefaultelns:MessageID"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                                    variable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable"
                                    part="pRequest"
                                    query="/ns4:BsScheduleLocationsRequest/ns4:EBCHeader/ns7:messageId"/>
                            </copy>
                            <copy>
                                <from expression="ora:getPreference('environmentId')"/>
                                <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                                    variable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable"
                                    part="pRequest"
                                    query="/ns4:BsScheduleLocationsRequest/ns4:EBCHeader/ns7:environmentId"/>
                            </copy>
                        </assign>
                        -->
                    </sequence>
                </scope>
                <scope name="Operate" id="BpScp4">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">OperateScope</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <sequence id="BpSeq9">
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe8">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.enterOperate(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"), getVariableData("EBM_HEADER"));
                        </bpelx:exec>
                        <assign name="SetupOperateDebug" id="BpAss7">
                            <copy>
                                <from variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                                <to variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                            </copy>
                        </assign>
                        <assign name="SetupOperate" id="BpAss8">
                            <bpelx:annotation>
                                <bpelx:pattern>transformation</bpelx:pattern>
                            </bpelx:annotation>
                            <copy>
                                <from expression="ora:doXSLTransformForDoc('../Transformations/AddTargetSystemID.xsl', $CreateDeliveryScheduleReqMsg.CreateDeliveryScheduleEBM)"/>
                                <to variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                            </copy>
                        </assign>
                        <assign name="Assign_EBM_HEADER_WithTargetSystemNode" id="BpAss9">
                            <copy>
                                <from variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM" query="/ns1:CreateDeliveryScheduleEBM/coreheader:EBMHeader"/>
                                <to variable="EBM_HEADER" query="/coreheader:EBMHeader"/>
                            </copy>
                        </assign>
                        <assign name="SetupOperateDebug" id="BpAss10">
                            <copy>
                                <from variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                                <to variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                            </copy>
                            <copy>
                                <from expression="'{ikea.com/system/iip/CreateDeliveryScheduleDESProvABCSService/1.0/}CreateDeliveryScheduleDESProvABCS'"/>
                                <to variable="ServiceName"/>
                            </copy>
                            <copy>
                                <from variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM" query="/ns1:CreateDeliveryScheduleEBM/coreheader:EBMHeader/coreheader:Target/coreheader:ID"/>
                                <to variable="SystemID"/>
                            </copy>
                        </assign>
                        <scope name="BAMScope" bpelx:skipCondition="ora:getPreference('reportToBAM')='false'" id="BpScp5">
                            <faultHandlers id="BpFhs1">
                                <catchAll id="BpCAl1">
                                    <empty name="Empty" id="BpEmp0"/>
                                </catchAll>
                            </faultHandlers>
                            <sequence name="BAMSequence" id="BpSeq10">
                                <assign name="Assign_BAMSensor_InputData" id="BpAss11">
                                    <copy>
                                        <from expression="ora:getECID()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:technicalIdentifier"/>
                                    </copy>
                                    <copy>
                                        <from expression="'IIP'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:source"/>
                                    </copy>
                                    <copy>
                                        <from expression="'DES'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:target"/>
                                    </copy>
                                    <copy>
                                        <from expression="'ABCSProviderReq'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:sourceType"/>
                                    </copy>
                                    <copy>
                                        <from expression="ora:getProcessId()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:serviceName"/>
                                    </copy>
                                    <copy>
                                        <from expression="'Sent'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:status"/>
                                    </copy>
                                    <copy>
                                        <from expression="xp20:current-dateTime()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                    </copy>
                                    <copy>
                                        <from expression="'SOA'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:implementationType"/>
                                    </copy>
                                    <copy>
                                        <from expression="'RequestReply'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:integrationType"/>
                                    </copy>
                                    <copy>
                                        <from expression="ora:getFlowId()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:instanceId"/>
                                    </copy>
                                    <copy>
                                        <from expression="'IIP'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:createdName"/>
                                    </copy>
                                    <copy>
                                        <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:creationDate"/>
                                    </copy>
                                    <copy>
                                        <from expression="'OIP_DELIVERY_00002_DELIVERYSCHEDULE'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERIntegrationContractName"/>
                                    </copy>
                                    <copy>
                                        <from expression="'od.del.des.DeliverySchedule'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERServiceSpecificationName"/>
                                    </copy>
                                    <copy>
                                        <from expression="'1'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERServiceSpecificationVersion"/>
                                    </copy>
                                    <copy>
                                        <from expression="'CallOut'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAInvocationPoint"/>
                                    </copy>
                                    <copy>
                                        <from expression="'ShipmentNo'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:BusinessObjects/bam:BusinessObject/bam:BusinessIdentifiers/bam:BusinessIdentifier/bam:BKey"/>
                                    </copy>
                                    <copy>
                                        <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:BusinessObjects/bam:BusinessObject/bam:BusinessIdentifiers/bam:BusinessIdentifier/bam:BValue"/>
                                    </copy>
                                </assign>
                                <assign name="Assign_BAMSensors_trigger" id="BpAss12">
                                    <copy>
                                        <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageSensorVariable"/>
                                    </copy>
                                </assign>
                            </sequence>
                        </scope>
                        <scope name="WS_Lookup_And_ActualWSCall_Scope" id="BpScp6">
                            <sequence name="WS_Lookup_And_ActualWSCall_Sequence" id="BpSeq11">
                                <assign name="Assign_DesUrl" id="BpAss13">
                                    <copy>
                                        <from expression="dvm:lookupValue('oramds:/apps/AIAMetaData/IIPComponents/dvm/DeliverySchedule/DeliveryScheduleWsEndpoints.dvm','DES_WS_ENDPOINT',ora:getPreference('desEnvironment'),'Url','')"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="endPointRef" query="/wsa:EndpointReference/wsa:Address"/>
                                    </copy>
                                    <copy>
                                        <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="endPointRef"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" partnerLink="CreateDeliveryScheduleDES"/>
                                    </copy>
                                </assign>
                                <invoke name="Invoke_CreateDeliveryScheduleDES" inputVariable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable" outputVariable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable" partnerLink="CreateDeliveryScheduleDES" portType="ns4:EBCDEPDS01" operation="ScheduleLocations" bpelx:invokeAsDetail="no" id="BpInv0"/>
                            </sequence>
                        </scope>
                        <!--invoke name="Invoke1"
                                inputVariable="Invoke1_CreateDeliverySchedule_InputVariable"
                                outputVariable="Invoke1_CreateDeliverySchedule_OutputVariable"
                                partnerLink="CreateDeliveryScheduleDES"
                                portType="ns4:EBCDEPDS01"
                                operation="CreateDeliverySchedule"
                                bpelx:invokeAsDetail="no"/-->
                        <!--assign name="Assign1">
                            <copy>
                                <from variable="CreateDeliveryScheduleReqMsg"
                                      part="CreateDeliveryScheduleEBM"
                                      query="/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoShipmentCns/ns1:ShipmentId"/>
                                <to variable="Title"/>
                            </copy>
                        </assign-->
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe9">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.exitOperate(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <switch name="Switch1" id="BpSwt0">
                            <case condition="ora:countNodes(bpws:getVariableData('Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable','pResponse','/ns4:BsScheduleLocationsResponse/ns4:ERRORS'))>0">
                                <bpelx:annotation>
                                    <bpelx:general>
                                        <bpelx:property name="userLabel">IsErrorFromDES</bpelx:property>
                                    </bpelx:general>
                                </bpelx:annotation>
                                <assign name="Xform_CreateDeliveryScheduleErrorMessage" id="BpAss14">
                                    <bpelx:annotation>
                                        <bpelx:pattern>transformation</bpelx:pattern>
                                    </bpelx:annotation>
                                    <copy>
                                        <from expression="ora:doXSLTransformForDoc('../Transformations/Xform_DeliveryScheduleErrorMessage.xsl', $Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable.pResponse)"/>
                                        <to variable="CreateDeliveryScheduleResMsg" part="CreateDeliveryScheduleResponseEBM"/>
                                    </copy>
                                </assign>
                            </case>
                            <case condition="ora:countNodes(bpws:getVariableData('Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable','pResponse','/ns4:BsScheduleLocationsResponse/ns4:OutVoSchedulingResponse'))>0">
                                <bpelx:annotation>
                                    <bpelx:general>
                                        <bpelx:property name="userLabel">IsResponseFromDES</bpelx:property>
                                    </bpelx:general>
                                </bpelx:annotation>
                                <sequence id="BpSeq12">
                                    <assign name="Xform_CreateDeliveryScheduleResponseMessage_To_CreateDeliveryScheduleResMsg" id="BpAss15">
                                        <bpelx:annotation>
                                            <bpelx:pattern>transformation</bpelx:pattern>
                                        </bpelx:annotation>
                                        <copy>
                                            <from expression="ora:doXSLTransformForDoc('../Transformations/Xform_CreateDeliveryScheduleResponseMessage_To_CreateDeliveryScheduleResMsg.xsl', $Invoke_CreateDeliveryScheduleDES_ScheduleLocations_OutputVariable.pResponse)"/>
                                            <to variable="CreateDeliveryScheduleResMsg" part="CreateDeliveryScheduleResponseEBM"/>
                                        </copy>
                                    </assign>
                                </sequence>
                            </case>
                            <otherwise>
                                <sequence name="Sequence1" id="BpSeq13">
                                    <empty name="DoNothing" id="BpEmp1"/>
                                </sequence>
                            </otherwise>
                        </switch></sequence>
                </scope>
                <scope name="TransformResponse" id="BpScp7">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">TransformScope</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <sequence id="BpSeq14">
                        <bpelx:exec name="TraceLog" version="1.5" language="java" id="BxExe10">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceTransform(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <assign name="Assign_EBM_HEADER_To_RespEBM" id="BpAss16">
                            <bpelx:insertBefore>
                                <bpelx:from variable="EBM_HEADER" query="/coreheader:EBMHeader"/>
                                <bpelx:to variable="CreateDeliveryScheduleResMsg" part="CreateDeliveryScheduleResponseEBM" query="/ns1:CreateDeliveryScheduleResponseEBM/ns1:DataArea"/>
                            </bpelx:insertBefore>
                        </assign>
                        <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe11">
                            java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.stopInstance(getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                        </bpelx:exec>
                        <scope name="BAMScope" bpelx:skipCondition="ora:getPreference('reportToBAM')='false'" id="BpScp8">
                            <faultHandlers id="BpFhs2">
                                <catchAll id="BpCAl2">
                                    <empty name="Empty" id="BpEmp2"/>
                                </catchAll>
                            </faultHandlers>
                            <sequence name="BAMSequence" id="BpSeq15">
                                <assign name="Assign_BAMSensor_InputData" id="BpAss17">
                                    <copy>
                                        <from expression="'DES'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:source"/>
                                    </copy>
                                    <copy>
                                        <from expression="'IIP'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:target"/>
                                    </copy>
                                    <copy>
                                        <from expression="'ABCSProviderRes'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:sourceType"/>
                                    </copy>
                                    <copy>
                                        <from expression="'Received'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:status"/>
                                    </copy>
                                    <copy>
                                        <from expression="xp20:current-dateTime()" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPReceivedDate"/>
                                    </copy>
                                    <copy>
                                        <from expression="''" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                    </copy>
                                    <copy>
                                        <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPReceivedDate"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:creationDate"/>
                                    </copy>
                                    <copy>
                                        <from expression="'CallIn'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAInvocationPoint"/>
                                    </copy>
                                </assign>
                                <assign name="Assign_BAMSensors_trigger" id="BpAss18">
                                    <copy>
                                        <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageSensorVariable"/>
                                    </copy>
                                </assign>
                            </sequence>
                        </scope>
                        <sequence id="BpSeq16">
                            <reply name="CreateDeliverySchedule_Reply" variable="CreateDeliveryScheduleResMsg" portType="abcsns:CreateDeliveryScheduleDESProvABCS" partnerLink="CreateDeliveryScheduleDESProvABCS" operation="CreateDeliverySchedule" id="BpRpl0"/>
                        </sequence>
                    </sequence>
                </scope>
            </sequence>
        </scope>
        <scope name="ErrorScope" id="BpScp9">
            <switch name="isError" id="BpSwt1">
                <case condition="bpws:getVariableData('IsError') = true()">
                    <bpelx:annotation>
                        <bpelx:general>
                            <bpelx:property name="userLabel">isError</bpelx:property>
                        </bpelx:general>
                    </bpelx:annotation>
                    <scope name="Error" id="BpScp10">
                        <bpelx:annotation>
                            <bpelx:general>
                                <bpelx:property name="userLabel">ErrorScope</bpelx:property>
                            </bpelx:general>
                        </bpelx:annotation>
                        <sequence name="Sequence_SubLanguageExecutionFault" id="BpSeq17">
                            <assign name="Assign_Error" id="BpAss19">
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="ora:getProcessId()"/>
                                    <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:FaultingService/corefault:FaultingServiceName"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="CreateDeliveryScheduleReqMsg" part="CreateDeliveryScheduleEBM"/>
                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:SenderMessageReference/corefault:Payload"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="Invoke_CreateDeliveryScheduleDES_ScheduleLocations_InputVariable" part="pRequest"/>
                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:TargetMessageReference/corefault:Payload"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))"/>
                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:TransactionID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="'SOA'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                    <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:FaultingService/corefault:FaultingServiceImplementationType"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="ora:getInstanceId()" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                    <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:FaultingService/corefault:FaultingServiceInstanceID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="ora:getECID()" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                    <to variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ECID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                    <from expression="ora:getFlowId()"/>
                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:InstanceID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'ITM'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:AlertSystemEndpointID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'IIP'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:SourceSystem"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'DES'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:TargetSystem"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'CreateDeliverySchedule'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:OperationName"/>
                                </copy>
                                <!--copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'od.del.itm.DeliverySchedule SS'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                                                        variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage"
                                                        query="/corefault:IIPFaultMessage/corefault:IntegrationContractNameVer"/>
                                </copy-->
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="oraext:generate-guid()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:GUID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="xp20:current-dateTime()"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ReportDateTime"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'E'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:SeverityLevel"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="'7200'"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:ErrorContext/corefault:ExpirationTime"/>
                                </copy>
                        
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:SenderMessageReference/corefault:MessageID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:SenderMessageReference/corefault:ObjectReferenceID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:TargetMessageReference/corefault:MessageID"/>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" bpelx:ignoreMissingFromData="yes">
                                        <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'), '-', bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))"/>
                                        <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage" query="/corefault:IIPFaultMessage/corefault:TargetMessageReference/corefault:ObjectReferenceID"/>
                                </copy>
                                
                            </assign>
                            <assign name="AssignFault" id="BpAss20">
                                <copy>
                                    <from variable="IIPAsyncErrorHandlingProcessRequestMessage" part="FaultMessage"/>
                                    <to variable="CreateDeliveryScheduleFaultMsg" part="FaultMessage"/>
                                </copy>
                            </assign>
                            <reply name="CreateDeliverySchedule_ReplyFault" faultName="abcsns:Fault" variable="CreateDeliveryScheduleFaultMsg" partnerLink="CreateDeliveryScheduleDESProvABCS" portType="abcsns:CreateDeliveryScheduleDESProvABCS" operation="CreateDeliverySchedule" id="BpRpl1"/>
                            <scope name="BAMScope" bpelx:skipCondition="ora:getPreference('reportToBAM')='false'" id="BpScp11">
                                <faultHandlers id="BpFhs3">
                                    <catchAll id="BpCAl3">
                                        <empty name="Empty" id="BpEmp3"/>
                                    </catchAll>
                                </faultHandlers>
                                <sequence name="BAMSequence" id="BpSeq18">
                                    <assign name="Assign_BAMSensor_InputData" id="BpAss21">
                                        <copy>
                                            <from expression="ora:getECID()"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:technicalIdentifier"/>
                                        </copy>
                                        <copy>
                                            <from expression="'IIP'"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:source"/>
                                        </copy>
                                        <copy>
                                            <from expression="'IIP'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:target"/>
                                        </copy>
                                        <copy>
                                            <from expression="'ABCSProviderReq'"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:sourceType"/>
                                        </copy>
                                        <copy>
                                            <from expression="ora:getProcessId()"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:serviceName"/>
                                        </copy>
                                        <copy>
                                            <from expression="'Failed'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:status"/>
                                        </copy>
                                        <copy>
                                            <from expression="''"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPReceivedDate"/>
                                        </copy>
                                        <copy>
                                            <from expression="xp20:current-dateTime()"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                        </copy>
                                        <copy>
                                            <from expression="'SOA'"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:implementationType"/>
                                        </copy>
                                        <copy>
                                            <from expression="'RequestReply'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:integrationType"/>
                                        </copy>
                                        <copy>
                                            <from expression="ora:getFlowId()"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:instanceId"/>
                                        </copy>
                                        <copy>
                                            <from expression="'IIP'"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:createdName"/>
                                        </copy>
                                        <copy>
                                            <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:creationDate"/>
                                        </copy>
                                        <copy>
                                            <from expression="'OIP_DELIVERY_00002_DELIVERYSCHEDULE'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERIntegrationContractName"/>
                                        </copy>
                                        <copy>
                                            <from expression="'od.del.des.DeliverySchedule'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERServiceSpecificationName"/>
                                        </copy>
                                        <copy>
                                            <from expression="'1'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAOERServiceSpecificationVersion"/>
                                        </copy>
                                        <copy>
                                            <from expression="'CallOut'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAInvocationPoint"/>
                                        </copy>
                                        <copy>
                                            <from expression="'ShipmentNo'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:BusinessObjects/bam:BusinessObject/bam:BusinessIdentifiers/bam:BusinessIdentifier/bam:BKey"/>
                                        </copy>
                                        <copy>
                                            <from expression="concat(bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:Code'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:Creator/ns1:BuType'),'-',bpws:getVariableData('CreateDeliveryScheduleReqMsg','CreateDeliveryScheduleEBM','/ns1:CreateDeliveryScheduleEBM/ns1:DataArea/ns1:CreateDeliverySchedule/ns1:DeliverySchedule/ns1:DATA/ns1:InVoSchedulingRequestITM/ns1:ShipmentId/ns1:ShpNumber'))" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:BusinessObjects/bam:BusinessObject/bam:BusinessIdentifiers/bam:BusinessIdentifier/bam:BValue"/>
                                        </copy>
                                    </assign>
                                    <switch name="Switch2" id="BpSwt2">
                                        <case condition="bpws:getVariableData('isTargetError') = true()">
                                            <bpelx:annotation>
                                                <bpelx:general>
                                                    <bpelx:property name="userLabel">
                                                        CheckTargetError
                                                    </bpelx:property>
                                                </bpelx:general>
                                            </bpelx:annotation>
                                            <assign name="Assign_BAMSensor_InputData" id="BpAss22">
                                                <copy>
                                                    <from expression="'DES'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:source"/>
                                                </copy>
                                                <copy>
                                                    <from expression="'IIP'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:target"/>
                                                </copy>
                                                <copy>
                                                    <from expression="'ABCSProviderRes'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:sourceType"/>
                                                </copy>
                                                <copy>
                                                    <from expression="'Failed'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:status"/>
                                                </copy>
                                                <copy>
                                                    <from expression="xp20:current-dateTime()" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPReceivedDate"/>
                                                </copy>
                                                <copy>
                                                    <from expression="''" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPForwardedDate"/>
                                                </copy>
                                                <copy>
                                                    <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IIPReceivedDate"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:creationDate"/>
                                                </copy>
                                                <copy>
                                                    <from expression="'CallIn'" bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"/>
                                                    <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable" query="/bam:bamAuditMessageRequest/bam:bamAuditMessage/bam:IKEAInvocationPoint"/>
                                                </copy>
                                            </assign>
                                        </case>
                                    </switch>
                                    <assign name="Assign_BAMSensors_trigger" id="BpAss23">
                                        <copy>
                                            <from bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageVariable"/>
                                            <to bpelx:language="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0" variable="BamAuditMessageSensorVariable"/>
                                        </copy>
                                    </assign>
                                </sequence>
                            </scope>
                            <invoke name="Invoke_IIPAsyncErrorHandlingProcess" partnerLink="IIPAsyncErrorHandlingProcess" portType="ikeaeh:IIPAsyncErrorHandlingProcess" operation="notify" inputVariable="IIPAsyncErrorHandlingProcessRequestMessage" id="BpInv1"/>
                            <bpelx:exec name="TraceLog" language="java" version="1.5" id="BxExe12">
                                java.lang.Boolean isTrace = (java.lang.Boolean)getVariableData("TraceLogEnabled");   
                     if (isTrace) se.oraclesoa.iip.bpel.functions.Tracer.traceFault("ErrorHandler",getVariableData("Title"), getVariableData("InstanceID"), getVariableData("ServiceName"));
                            </bpelx:exec>
                        </sequence>
                    </scope>
                </case>
            </switch>
        </scope>
    </sequence>
</process>